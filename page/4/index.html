<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>bling on software</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.16-DEV" />
    <link href="http://bling.github.io/index.xml" rel="alternate" type="application/rss+xml" title="bling on software" />
    <link href="http://bling.github.io/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://bling.github.io/css/hc.css" rel="stylesheet">
    <link href="http://bling.github.io/css/custom.css" rel="stylesheet">
    <link href="http://bling.github.io/css/highlight.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    
    
  </head>
  <body>
    <div id = "wrapper">

      <div class="navbar navbar-default" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a href="http://bling.github.io/"><p class="navbar-brand">bling on software</p></a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              
              
            </ul>
          </div>
        </div>
      </div>



      
      <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-brand">
            <a href="http://bling.github.io/">
              <h1 class="brand">bling on software</h1>
            </a>
            <a href="/about">
              <img src="https://pbs.twimg.com/profile_images/1188386482/Untitled_bigger.png" />
            </a>
            <h3>when pragmatism meets minimalism</h3>
          </li>

          <hr />

          <div id="social-wrapper">
            <li> <a href="https://github.com/bling"><i class="fa fa-github-square"></i> github</a> </li>
            <li> <a href="https://twitter.com/blingcoder"><i class="fa fa-twitter-square"></i> @twitter</a></li>
            <li> <a href="https://linkedin.com/in/baileyling"><i class="fa fa-linkedin-square"></i> linkedin</a> </li>
          </div>

          <hr />

          <li class="sidebar-categories">
            <div>
              <span>Categories</span>
              <a href="/post" style="float:right">show all</a>
            </div>
            <div>
              
              <a href="/categories/blend">blend</a>
              
              <a href="/categories/castle">castle</a>
              
              <a href="/categories/castle-coding">castle-coding</a>
              
              <a href="/categories/coding">coding</a>
              
              <a href="/categories/cqrs">cqrs</a>
              
              <a href="/categories/emacs">emacs</a>
              
              <a href="/categories/forex">forex</a>
              
              <a href="/categories/ioc">ioc</a>
              
              <a href="/categories/javascript">javascript</a>
              
              <a href="/categories/logging">logging</a>
              
              <a href="/categories/powershell">powershell</a>
              
              <a href="/categories/rx">rx</a>
              
              <a href="/categories/software-tools">software-tools</a>
              
              <a href="/categories/source-control-management">source-control-management</a>
              
              <a href="/categories/testing">testing</a>
              
              <a href="/categories/twitter">twitter</a>
              
              <a href="/categories/vim">vim</a>
              
              <a href="/categories/visual-studio">visual-studio</a>
              
            </div>
          </li>
        </ul>
      </div>



      <div class="container">





<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2012/07/29/snoopshell-evolution/">SnoopShell: Evolution</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2012-07-29</small></p> <hr/>
  <div class="post">
    It’s been a while since I last announced SnoopShell, where I took some PowerShell and injected that into Snoop. Well, I didn’t stop there! I decided to continue working on it and adding more useful features. Well, a bunch of things have changed. For one, it’s no longer targeted at .NET 4 and PS v3 anymore (and you’ll soon know why). Second, there’s a bunch of new features! Automatic Profile Loading Upon startup, the shell will look for a couple well known locations and automatically dot-source them to load them into the current session. This works the same as the standard $profile. The filename needs to be SnoopProfile.ps1, and the search paths are %USERPROFILE%, the WindowsPowerShell, and the Scripts folder deployed with Snoop.exe. This is incredibly useful since you can write your own custom functions and scripts and have them available to you all the time. As an added bonus, because of the dynamic nature of PowerShell, you can make modifications to the SnoopProfile.ps1, save, and then invoke a . $profile to reload the profile and update the session with your changes (all without restarting the application). That’s awesome sauce indeed ;-) PowerShell Provider This was more of a for-fun thing at first just to see if I could do it. Writing a PS provider is not fun at all, since it’s not very well documented and I actually needed some help from ILSpy to figure out how things really worked. Nonetheless, it’s got some basic functionality that is helpful to navigate around. Yep, the selected grid actually has a path, like how you would navigate the file system. Let’s see what happens with a cd. Cool, you can cd into the child “directory”, and it’ll automatically select the item in the tree view as well. What if you’re lazy and don’t want to type? Wildcards are supported. And because the visual tree doesn’t exactly require unique names, I needed to trick it by adding a number after each duplicate item. So the above matches the third Rectangle child of the Grid. Code Injection One of the cool things about Javascript is that it’s so darn easy to test. You make a change, save, reload, and you’ll immediately see if something worked or not. This feedback loop is so fast it changes how you work and formulate ideas. In the static world, we don’t really have this luxury, and especially not when you’re working on a large project, which at work, takes just under a minute for a full rebuild. And this is on a monster machine. Because of this, we had to employ tricks and workarounds to speed things up, like messing with build configurations and build output paths to minimize duplicate work. Despite that, it’s still a pain to wait for the application to start and all that jazz. What if we could do the super fast feedback loop development, in a static world? Well, now you can! It starts with a simple function: function replace-command([string]$msg = &#39;hello world&#39;) { $action = { [system.windows.messagebox]::show($msg) }.GetNewClosure() $cmd = new-object galasoft.mvvmlight.command.relaycommand([system.action]$action) $selected.target.command = $cmd } The above function will replace anything that has a Command property on the target, like a Button or MenuItem, with a MessageBox showing a message. For the curious, GetNewClosure is needed so that $msg is available within the inner script block. Unlike C#, closures are not automatic. Since PowerShell is dynamic, if you need to make a change, simply save the script, reload it with a dot-source, which will overwrite the existing function, and then set the target’s Command property again. Awesome! The only annoyance is converting PowerShell code back into C# code once you’re done. Evolution If you made it this far you didn’t forget about my comment about untargeting .NET 4 and PS v3. Well, changes have been merged to the main branch! Soon the masses will be able to experiment with supercharging their applications with PowerShell! I’ll likely continue working on my fork as there’s still more goodies I’d like to add. Stay tuned!

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2012/07/01/snoopshell-marriage-of-snoop-wpf-and/">SnoopShell: The marriage of Snoop WPF and PowerShell</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2012-07-01</small></p> <hr/>
  <div class="post">
    I was given the opportunity to review a couple chapters of the excellent book PowerShell for Developers, written by my colleague Doug Finke.&nbsp; One of the concepts in the book was embedding a PowerShell console into your application.&nbsp; This idea is ingenious and we added this feature to our client’s software, and so far it has increased our productivity and opened the doors to many possibilities. So what’s so cool about embedding a shell into your application?&nbsp; Well, for starters, one of the immediate advantages is that it gives you the opportunity to test your application at run time.&nbsp; If you are implementing the MVVM pattern then basically anything you can see in the UI is bound to some property in your view model.&nbsp; What if you could expose an instance of your view model to the PowerShell console?&nbsp; Yes, you would be able to interact with it directly, change values, and property change notification will kick in and update the UI. The possibilities start to open up from there.&nbsp; You can start scripting out common tasks – write once, run many times.&nbsp; Or you can write a full fledge test suite as a script, give it to a QA tester, and have them run through it as a special kind of integration testing, one that happens with live, real data.&nbsp; Or how about being able to modify code, at runtime, to try out an implementation without need to recompile or restart the application?&nbsp; Sounds pretty awesome to me! With this, I started thinking why don’t I try and add this to Snoop?&nbsp; It’s a staple tool for any WPF developer, and adding scripting capabilities to Snoop will make it even more useful. So, I sat down for a weekend and took a shot at it.&nbsp; And with that, SnoopShell was born! My fork of Snoop can be found here: https://github.com/bling/snoopwpf It’s still in super-duper alpha, so features/ideas are still getting formulated, but here’s a glimpse of what it can do now. The $root variable points to the root of the tree.&nbsp; As you can see, Snoop represents this as a ApplicationTreeItem, which has a bunch of properties, the important ones being IsSelected and IsExpanded. Let’s try interacting with the object by setting the IsExpanded to true. So far so good.&nbsp; Now let’s find my username using Ctrl+Shift.&nbsp; The $selected variable is automatically synchronized with the selected item in the tree. Let’s do some black magic and change my name. Finally, let’s find every ListBox in the application.&nbsp; Find-Item is used to recursively find everything in the visual tree which is a ListBox. And from here, it’s as simple as grabbing the DataContext of any control to get access to the view model. By the way, this is targeting PowerShell V3, so you will need to have the RC installed. Try it out and let me know what you think!

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2012/06/08/n2n-net-2-node-part-1/">N2N: .NET 2 Node: Part 1</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2012-06-08</small></p> <hr/>
  <div class="post">
    Let’s get some actual coding done.&nbsp; If you want some basic prologue, check out the first part of my series here. Anywho, let’s get to the meat of what we’re trying to accomplish.&nbsp; I will start with the typical C# class you would write, do the same in Javascript, and then again in C#, but using the style of Javascript using closures. Here’s the use case: Handle a web request Check the MongoDB database to see if an entry exists and return it if available. Otherwise, query an external API for data, save it into MongoDB, and then return that. This is a pretty standard straight-forward approach in web applications.&nbsp; If you’re not using MongoDB, you’ll be using memcache, Redis, or some other equivalent data store. First, let’s implement an pseudo-code ASP.NET MVC controller which does the above: public class QuoteController : Controller { MongoCollection collection; IExternalApi external; public ActionResult Get(string symbol) { var quote = this.collection.FindOne(new { symbol }); if (quote == null) { var json = this.external.GetQuote(symbol); this.collection.Save(json); } ViewBag.Quote = quote; return View(); } } Error handling and initialization are omitted for brevity, but it’s an otherwise straight-forward synchronous send JSON to the browser response.&nbsp; So how does something like this look in Node?&nbsp; First, let’s throw in a web framework.&nbsp; I picked Express because it seems to have the most traction right now.&nbsp; Again, for brevity I will omit a bunch of boot strapping code, and skip to the core logic. var QuoteService = function() { var mongoCollection; // new MongoCollection var external; // new External API // req/res are the request/response passed in by Node/Express this.get = function(symbol, req, res) { mongoCollection.findOne({ symbol: symbol }, function(error, item) { if (item === null) { external.getQuote(symbol, function(error, result) { mongoCollection.save(result); req.write(result); req.end(); }); } else { req.write(item); req.end(); } }); }; }; module.exports = QuoteService; OK, looks a lot different!&nbsp; The first thing you’ll notice is that the class is actually a function.&nbsp; Javascript doesn’t have real classes like C# or Java, but you can simulate things like private and public members by using closures.&nbsp; In the code snippet above, mongoCollection and external are private variables.&nbsp; However, the get function is public because it’s prefixed with this.&nbsp; Finally, because Javascript has closures you can still access the private variables and retain their state. Last but not least, as far as programming in Node is concerned, every function returns void.&nbsp; Node is extremely fast – but it is still single threaded, which means you need to take extreme care not to block on any operation.&nbsp; In summary, you need to get used to working with callbacks.&nbsp; In the example above, the callback for the Mongo query invokes another function, which again uses a callback for the result.&nbsp; Typically any errors are also passed through to the callback, so in place of try/catch blocks, you will be checking to see if the error parameter has a value. To conclude, let’s write a C# version that mimics the Javascript style. public static void Main(string[] args) { var QuoteService = new Func&lt;dynamic&gt;(() =&gt; { var mongoCollection = new MongoCollection(); var external = new IExternalApi(); return new { get = new Action&lt;string, Request, Response&gt;((symbol, req, res) =&gt; { mongoCollection.FindOne(new{symbol}, (error, item) =&gt; { if (item == null) { external.GetSymbol(symbol, (e, result) =&gt; { mongoCollection.Save(result); req.Write(result); req.End(); }); } else { req.Write(item); req.End(); } }); }) }}); } 100% valid C# syntax. Would you ever want to do that in C#?&nbsp; Probably not.&nbsp; But if you need some mental conversion from C# to/from Javascript, I think it’s a good place to start. In summary, Javascript is kind of like programming in C# using only anonymous classes, Action/Func, dynamic, declared all in the main method.

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2012/06/03/n2n-net-2-node/">N2N: .NET 2 Node</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2012-06-03</small></p> <hr/>
  <div class="post">
    Well, it’s been quite a while since I’ve blogged about…well…anything, and I figured it’s about time I get off my lazy butt and do something with my spare time on weekends.&nbsp; What better option than to see what all the hype is about Node?&nbsp; I had to do it sooner or later. As any newbie would do, they go to Google and type “nodejs tutorial”.&nbsp; The Node Beginner Book came up first, so I went with that.&nbsp; It was an excellent tutorial.&nbsp; Prior to this I also skimmed through the book JavaScript, The Good Parts, so I had a basic understanding of the language syntax. One of the first oddities I noticed, was that NodeJS seems to have a convention of comma-first.&nbsp; You notice this immediately because most examples start with require(‘module’), and if they require more than one module, the second line is prefixed with a comma (as opposed to the more traditional comma at the end of the line).&nbsp; I apparently missed the discussion by 2 years!&nbsp; It was still interesting nonetheless. As someone with a strong .NET background, I definitely experienced all the usual ‘gotchas’: == vs === falsey values variable hoisting Once you understand all of these things, Javascript isn’t so bad.&nbsp; Oh, and of course understanding closures will get you a long way in being effective with Javascript, because that’s what you need to use to do proper scoping.&nbsp; If C# didn’t have lambdas and closures it would have been a much longer journey to “get it”. Not too longer after, I deployed my first Heroku app running on NodeJS. Anyways, enough with the prologue…I won’t bore you with anymore beginner/tutorial stuff. Let’s get on with what I plan on doing over a multi-part blog series.&nbsp; When I build something on my own time, I can’t build something just for the hell of it to learn something….that’s not enough.&nbsp; If I build something it has to be useful – something that I (or someone else) will find valuable. I won’t reveal what it is yet, but it’s going to involve Node/MongoDB on the backend, with Backbone on the front-end.&nbsp; Should be fun :-)

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2011/10/31/my-thoughts-on-mef/">My Thoughts on MEF</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2011-10-31</small></p> <hr/>
  <div class="post">
    Ever since MEF was conceived, despite the authors saying that it is not an IoC container, it has since evolved to become one of the more popular IoC containers.&nbsp; I’ve always avoided it because I disagree with using attributes, and I’ve had no reason to use it over Autofac or Windsor. Recently, I found a reason to use it – Metro-style applications only support MEF so far.&nbsp; My Twitter client ping.pong uses Autofac as the IoC container.&nbsp; It uses some very basic functionality like factories and hooks.&nbsp; To my surprise, MEF has no support for either of these. Coming across these limitations solidifies my opinion that MEF is a plugin container, not an IoC container. First let’s take a look at automated factories. What I mean is that by registering Foo, like so: container.RegisterType&lt;Foo&gt;(); the container will automatically provide us a Func&lt;Foo&gt; without explicitly having to register it. This can be useful when you want to create an instance of Foo some time in the future rather than at constructor time.&nbsp; You can do this with MEF via an ExportFactory&lt;T&gt;, but it’s limited because you cannot override dependencies at resolve time. For example, let’s say Foo has a constructor of Foo(Bar1, Bar2, Bar3). With MEF, you have no control at resolution time what the Bars are. A container that has support for automated factories (like Autofac and Castle Windsor), will let you resolve a Func&lt;Bar1, Foo&gt;, which lets you override Bar1 at resolve time. Similarly, you can resolve a Func&lt;Bar1, Bar2, Bar3, Foo&gt; and override all dependencies. Any dependencies not overridden fall back to their configuration in the bootstrapper. This is a very useful feature, and coupled with the scoping features for automatic disposal it opens up many doors for elegant solutions for what otherwise are complicated problems. On to the second point; MEF has limited extension points. This one sounds odd since MEF is all about designing decoupled plugins so surely it should have extension points! The problem here is that MEF is designed as an explicit API (attributes are required) rather than an implicit API. In Autofac, you can scan an assembly and register every type. In MEF, every class needs to have an [Export] on it.&nbsp; It also baffles my mind why [ImportingConstructor] is required even when there’s only one constructor. All this explicitness means you lose a bunch of “free” extension points that typical IoC containers have, like this: b.RegisterAssemblyTypes(GetType().Assembly) .OnActivated(x =&gt; x.Context.Resolve&lt;IEventAggregator&gt;().Subscribe(x.Instance)); What the code above is saying that every time any component is activated, it will subscribe to the event aggregator. If the component doesn’t IHandle&lt;&gt; any messages, it’s a no-op and continues on. If the instance does IHandle&lt;&gt; messages, this will ensure it’s hooked up. The closest thing I could find in MEF was IPartImportsSatisfiedNotification (yes, an interface, more explicitness!).&nbsp; It contains a single method OnImportsSatisfied() which gets called when the part is created.&nbsp; Needless to say, the one line of code from Autofac would translate into a method for every implementation of IHandle&lt;&gt;, and since OnImportsSatisfied() contains no contextual information, every component will need IEventAggregator injected just to be able to call Subscribe. To fully complete this example, Autofac has the following methods when registering a component: OnRegistered, OnPreparing, OnActivating, OnActivated, and OnRelease.&nbsp; Each of these methods gives you complete contextual information at the time it is called like access to the current scope of the container, the instance (if applicable), which component which requested the dependency, etc.&nbsp; This makes it almost too easy to extend the container. For MEF, the only real extension point is an ExportProvider.&nbsp; It is pretty low level (all it does is parse attributes for you) so to write anything similar for MEF requires a lot more code.&nbsp; To further illustrate this point, compare the interception modules from AutofacContrib and MefContrib.&nbsp; The Autofac implementation is a single file with a couple extension methods.&nbsp; The MEF implementation is an entire namespace, over multiple classes, not the mention that it also relies on other infrastructure code in MefContrib.&nbsp; Basically, the guys that wrote MefContrib had to write a mini-container within MEF. MEF is great for building extremely loosely coupled applications.&nbsp; I don’t think it has any business in an application where you know and own all of the dependencies; there are simply better libraries for that. Comments bling Thanks for the reply Nick! I have yet to check out all the new MEF features of 4.5, but it definitely looks very interesting with what&#39;s happening in the previews. The new RegistrationBuilder looks pretty good, especially since attributes are optional now, but that only solves wiring up the application. IMO, the most useful (and powerful) thing you can add is the equivalent of Autofac&#39;s IComponentContext -- something that will let you easily hook into any part of the resolution chain from creation to disposal. Once that&#39;s in it&#39;ll be much easier to extend the container and use it for more &quot;advanced&quot; scenarios --and with less code. Cheers, Bailey Nick Hi Bailey! Nice thoughtful article - I have a foot in both camps, so I&#39;m glad that the Autofac extension points work for you, but I&#39;m also keen to close some of the gaps on the MEF side :) I am curious, have you had a chance to look at RegistrationBuilder, being delivered in the .NET 4.5 version of MEF? It opens up the possibility for us to support activation events like the ones you mention, although it doesn&#39;t as of writing. In case you didn&#39;t catch it, the release announcement is at: http://blogs.msdn.com/b/bclteam/archive/2011/10/27/what-s-new-in-mef-version-2-preview-4.aspx Thanks for writing this up anyway, it will give us something to think about. Regards, Nick

    
  </div>
</div>



    
    <ul class="pagination">
        
        <li>
            <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
        </li>
        
        <li
        >
        <a href="/page/3/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
        </li>
        
        <li
        ><a href="/">1</a></li>
        
        <li
        ><a href="/page/2/">2</a></li>
        
        <li
        ><a href="/page/3/">3</a></li>
        
        <li
        class="active"><a href="/page/4/">4</a></li>
        
        <li
        ><a href="/page/5/">5</a></li>
        
        <li
        ><a href="/page/6/">6</a></li>
        
        <li
        ><a href="/page/7/">7</a></li>
        
        <li
        ><a href="/page/8/">8</a></li>
        
        <li
        ><a href="/page/9/">9</a></li>
        
        <li
        ><a href="/page/10/">10</a></li>
        
        <li
        ><a href="/page/11/">11</a></li>
        
        <li
        ><a href="/page/12/">12</a></li>
        
        <li
        ><a href="/page/13/">13</a></li>
        
        <li
        ><a href="/page/14/">14</a></li>
        
        <li
        ><a href="/page/15/">15</a></li>
        
        <li
        ><a href="/page/16/">16</a></li>
        
        <li
        ><a href="/page/17/">17</a></li>
        
        <li
        >
        <a href="/page/5/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
        </li>
        
        <li>
            <a href="/page/17/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
        </li>
        
    </ul>
    

    </div>

    <footer>
      <p class="text-muted credit">&copy; bling on software 2015. All rights reserved. </p>
    </footer>

    <script src="http://bling.github.io/js/jquery-1.10.2.min.js"></script>
    <script src="http://bling.github.io/js/bootstrap.min.js"></script>
    <script src="http://bling.github.io/js/bootstrap.js"></script>
    <script type="text/javascript" src="http://bling.github.io/js/hc.js"></script>

    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38439430-2', 'auto');
ga('send', 'pageview');
</script>

  </body>
</html>

