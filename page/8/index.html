<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>bling on software</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.16-DEV" />
    <link href="http://bling.github.io/index.xml" rel="alternate" type="application/rss+xml" title="bling on software" />
    <link href="http://bling.github.io/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://bling.github.io/css/hc.css" rel="stylesheet">
    <link href="http://bling.github.io/css/custom.css" rel="stylesheet">
    <link href="http://bling.github.io/css/highlight.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    
    
  </head>
  <body>
    <div id = "wrapper">

      <div class="navbar navbar-default" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a href="http://bling.github.io/"><p class="navbar-brand">bling on software</p></a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              
              
            </ul>
          </div>
        </div>
      </div>



      
      <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-brand">
            <a href="http://bling.github.io/">
              <h1 class="brand">bling on software</h1>
            </a>
            <a href="/about">
              <img src="https://pbs.twimg.com/profile_images/1188386482/Untitled_bigger.png" />
            </a>
            <h3>when pragmatism meets minimalism</h3>
          </li>

          <hr />

          <div id="social-wrapper">
            <li> <a href="https://github.com/bling"><i class="fa fa-github-square"></i> github</a> </li>
            <li> <a href="https://twitter.com/blingcoder"><i class="fa fa-twitter-square"></i> @twitter</a></li>
            <li> <a href="https://linkedin.com/in/baileyling"><i class="fa fa-linkedin-square"></i> linkedin</a> </li>
          </div>

          <hr />

          <li class="sidebar-categories">
            <div>
              <span>Categories</span>
              <a href="/post" style="float:right">show all</a>
            </div>
            <div>
              
              <a href="/categories/blend">blend</a>
              
              <a href="/categories/castle">castle</a>
              
              <a href="/categories/castle-coding">castle-coding</a>
              
              <a href="/categories/coding">coding</a>
              
              <a href="/categories/cqrs">cqrs</a>
              
              <a href="/categories/emacs">emacs</a>
              
              <a href="/categories/forex">forex</a>
              
              <a href="/categories/ioc">ioc</a>
              
              <a href="/categories/javascript">javascript</a>
              
              <a href="/categories/logging">logging</a>
              
              <a href="/categories/powershell">powershell</a>
              
              <a href="/categories/rx">rx</a>
              
              <a href="/categories/software-tools">software-tools</a>
              
              <a href="/categories/source-control-management">source-control-management</a>
              
              <a href="/categories/testing">testing</a>
              
              <a href="/categories/twitter">twitter</a>
              
              <a href="/categories/vim">vim</a>
              
              <a href="/categories/visual-studio">visual-studio</a>
              
            </div>
          </li>
        </ul>
      </div>



      <div class="container">





<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2011/04/17/integrating-dependencypropertyweaver/">Integrating DependencyPropertyWeaver Into Your Build</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2011-04-17</small></p> <hr/>
  <div class="post">
    See the introduction here. The MSBuild task as it stands currently by default will attempt to weave everything that it finds.&nbsp; This is probably not optimal in most use cases, but any changes is a simple modification to the LINQ query in the code.&nbsp; For now, it’s only available in source format since there are bound to be bugs here and there, and once those get ironed out it’ll be easier to release a “point something” release. An example of how its used can be seen in the unit tests, in the project DependencyPropertyWeaver.Tests.Models.&nbsp; If you open it up in your favorite text editor, you will see this crucial line: &lt;Target Name="AfterBuild"&gt; &lt;Exec Command="C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe postbuild.proj /p:Files=DependencyPropertyWeaver.Tests.Models.dll" WorkingDirectory="$(OutputPath)" /&gt; &lt;/Target&gt; And the contents of postbuild.proj is simply this: &lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;Project ToolsVersion="4.0" DefaultTargets="Weave" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"&gt; &lt;UsingTask TaskName="DependencyPropertyWeaver.DependencyPropertyWeaverTask" AssemblyFile="DependencyPropertyWeaver.dll" /&gt; &lt;Target Name="Weave"&gt; &lt;ItemGroup&gt; &lt;Input Include="$(Files)" /&gt; &lt;/ItemGroup&gt; &lt;DependencyPropertyWeaverTask Files="@(Input)" /&gt; &lt;/Target&gt; &lt;/Project&gt; The AfterBuild target is a special target with MSBuild, which, as the name implies, will run after the target has been built.&nbsp; In this case, after the project is completed, it will invoke another MSBuild instance to perform the weaving.&nbsp; Invoking a new MSBuild process is required because the &lt;UsingTask&gt; will load the assembly into the current AppDomain, and once loaded it cannot be unloaded. If you don’t mind the unloading part, you can simply add the &lt;UsingTask&gt; directly into the project file and invoked the &lt;DependencyPropertyWeaverTask&gt; there, and avoid the hassle of having a separate file. Currently, the DependencyPropertyWeaverTask supports the TypePatternMatch and AttributePatternMatch, which as the names imply will use regular expression filtering on type names or properties with the attribute you want to weave.&nbsp; If these properties are null, they are ignored. Next on the feature list is weaving attached properties ;-)

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2011/04/15/introducing-dependencypropertyweaver/">Introducing DependencyPropertyWeaver</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2011-04-15</small></p> <hr/>
  <div class="post">
    As part of my demonstration for the NYC .NET Meetup in the next couple of days, I prepared some material to show how to use Mono.Cecil to manually weave IL as a post-build step.&nbsp; It solves the problem of what I call “WPF Verbosity Hell”: the thing that makes your eyes bleed and makes God kill a kitten every time you declare a new property. Since notifypropertyweaver already exists, I figured I’d release the other side of the coin, dependencypropertyweaver.&nbsp; I just pushed my changes onto GitHub. There are a couple of reasons to use dependency properties rather than regular properties with INotifyPropertyChanged.&nbsp; If you’re using WPF they make more sense because they perform faster and they give you a lot of extra bells and whistles for free.&nbsp; However, the INPC route tends to be more popular because it doesn’t bring in the dependency of WPF. IL post-build weaving solves the dependency problem because you can selectively choose to weave only the assemblies that get deployed with WPF, and you could even weave INPC into your service layer, and DPs into your client layer.&nbsp; That’s the power of post-build processes. While this little project initially started out as a simple demonstration of using Mono.Cecil to perform low-level aspect oriented principles, it didn’t take much more work to tidy things up and make it ‘releasable’ into the wild, so I did just that, and open sourced it. The concept is simple.&nbsp; You take something like this: public class Student { public string Name { get; set; } public int Age { get; set; } } .csharpcode, .csharpcode pre { font-size: small; color: black; font-family: consolas, "Courier New", courier, monospace; background-color: #ffffff; /*white-space: pre;*/ } .csharpcode pre { margin: 0em; } .csharpcode .rem { color: #008000; } .csharpcode .kwrd { color: #0000ff; } .csharpcode .str { color: #006080; } .csharpcode .op { color: #0000c0; } .csharpcode .preproc { color: #cc6633; } .csharpcode .asp { background-color: #ffff00; } .csharpcode .html { color: #800000; } .csharpcode .attr { color: #ff0000; } .csharpcode .alt { background-color: #f4f4f4; width: 100%; margin: 0em; } .csharpcode .lnum { color: #606060; } And DependencyPropertyWeaver will turn it into this: public class Student : DependencyObject { public static readonly DependencyProperty NameDependencyProperty = DependencyProperty.Register("Name", typeof(string), typeof(Student)); public static readonly DependencyProperty AgeDependencyProperty = DependencyProperty.Register("Age", typeof(int), typeof(Student)); public string Name { [CompilerGenerated] get { return (string)base.GetValue(Student.NameDependencyProperty); } [CompilerGenerated] set { base.SetValue(Student.NameDependencyProperty, value); } } public int Age { [CompilerGenerated] get { return (int)base.GetValue(Student.AgeDependencyProperty); } [CompilerGenerated] set { base.SetValue(Student.AgeDependencyProperty, value); } } } Even though the class initially didn’t inherit from DependencyObject, the weaved version does.&nbsp; It will also continually go up the inheritance chain until it finds the abstract base class, and makes that inherit from DependencyObject. Next on the list is obviously documentation (what open source project doesn’t need more documentation?!), however, I think I can slack off on this one since the core library is only 200-300 lines of code :-) Comments bling Welcome to the world of C# :) In C#, they are called attributes rather than annotations. The MSBuild task has a property named AttributePatternMatch, which is a regular expression to match on the name of the attribute you want to use to determine whether to weave a property or not. Keep in mind that the code is highly experimental. Hope that helps! campers Awesome, I&#39;ve just started working on my first c# job after 10 years of Java, so learning all this byte code manipulation again! Would it be possible to use annotations to determine if a class and its properties should or shouldn&#39;t be processed to create the dependancy properties?

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2011/03/10/that-commenting-thing/">That Commenting Thing</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2011-03-10</small></p> <hr/>
  <div class="post">
    I’m working on a project right now that has near 99% of its code commented.&nbsp; Wow, that’s impressive!&nbsp; Actually, it’s more scary…even some of the private fields are commented…. At one point, someone decided that it was a good idea to impose some kind of standard rather than none, so they recommended StyleCop with all of its default settings, including requiring comments on everything. This seemed like a good idea, and it probably was, until someone found GhostDoc.&nbsp; The plugin definitely gives off that “cool” factor the first time you use it.&nbsp; Wow, with a single key stroke it automagically documented all of my code!!!&nbsp; The problem, and it’s a pretty big one, is that it generates documentation based on the name of the properties, names, and class.&nbsp; Surely if it can do that, you, a much more sophisticated machine, can do that! Alas, the code base ended up getting GhostDocced to death all over the place to the point where I was driven mad and insane that I spent the time to write a VS2010 extension to purposely hide these comments.&nbsp; I’m talking about comments like this: The comments add absolutely no value and IMO makes it harder to read, and has the added deficit that if for whatever reason someone changes the name property, chances are they will forget to update the comments.&nbsp; It gets worse with WCF service contracts with many parameters. So yes, it frustrated me enough that I took some spare time to write an extension to shrink those damn XML comments to such a small size it doesn’t bother me anymore, like this: You can grab the code off GitHub. Comments bling Originally I tried to use code folding to solve the problem, but the best thing that comes built-in is collapsing to definitions (Ctrl+M/O), which will fold everything. But that also folds the methods as well, so then I&#39;d have to manually unfold them, which quickly got tiresome. The optimal solution I think would be for the extension to automatically collapse only the comments when you open a file, but that is much more complex than just changing the font size....maybe an exercise for another weekend when I&#39;m bored with nothing to do... Vsevolod Parfenov Why don&#39;t you fold them instead of changing font size?

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2010/12/11/auto-mocking-nsubstitute-with-castle/">Auto Mocking NSubstitute with Castle Windsor</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2010-12-11</small></p> <hr/>
  <div class="post">
    I was debating whether to make this blog post because it’s so damn simple to implement, but hey, if it saves someone else time, I did some good. First of all, register an ILazyComponentLoader into Windsor: var c = new WindsorContainer(); c.Register(Component.For&lt;LazyComponentAutoMocker&gt;()); Then, the implementation of LazyComponentAutoMocker is simply this: public class LazyComponentAutoMocker : ILazyComponentLoader { public IRegistration Load(string key, Type service, IDictionary arguments) { return Component.For(service).Instance(Substitute.For(new[] { service }, null)); } } And you’re done!&nbsp; Here’s a simple unit test example using only the code from above: [Test] public void IDictionary_Add_Invoked() { var dict = c.Resolve&lt;IDictionary&gt;(); dict.Add(1, 1); dict.Received().Add(1, 1); } That was almost too easy. Comments Randy For what it&#39;s worth, I found this helpful. I&#39;m new to Castle Windsor as well as NSubstitute. This post was able to get me going a lot quicker than sifting through documentation. Thanks.

    
  </div>
</div>

<div class="article">
  <div class="article-title">
    <a href="http://bling.github.io/blog/2010/12/05/working-in-git-to-working-in-mercurial/">Working in Git to Working in Mercurial</a>
  </div>
  <p class="meta"><small><i class="fa fa-calendar-o"></i> 2010-12-05</small></p> <hr/>
  <div class="post">
    I took the dive a couple weeks ago and learned how to use Git and fell in love with its simplicity.&nbsp; I don’t know what it is, but after using Git every day it actually started to make sense that git checkout is used for so many things, which is ironic because prior to using Git, every introductory tutorial I’ve read has always had me thinking, “checkout does what and what and what now??”. So why did I switch to Mercurial?&nbsp; I need to push/pull from a Subversion repository, and I work on Windows.&nbsp; General day to day work is great, but when I needed to git svn rebase or git svn dcommit it would take so long that I simply left to get coffee.&nbsp; What’s worse, no matter what I set for core.autocrlf I would always get some weird whitespace merging error, when nothing was wrong.&nbsp; It became a regular part of my workflow to just git rebase –skip everything because that’s what fixed things.&nbsp; Scary. The crappy Subversion and whitespace support (at least in Windows) led me to try Mercurial.&nbsp; After getting accustomed to Mercurial, they’re actually a lot more similar than they are different. First things first, you need to add the following to your mercurial.ini file in your home directory: [bookmarks] track.current = True Here’s a comparison of my typical Git workflow translated to Mercurial: &nbsp; Git Mercurial Work on a new feature/bug git checkout –b new_feature hg book new_feature Hack hack hack git add . &nbsp; Commit git commit –m “done!” hg commit –m “done!” Hack more and commit git commit –a –m “more hacking” hg commit –m “more hacking” Sync with up stream git pull master hg pull Merge git checkout master hg merge new_feature &nbsp; git merge new_feature hg commit –m “merged” Push git push hg push Notice that they’re practically exactly the same?&nbsp; There are some minor differences.&nbsp; The obvious one being that you need to add into git’s index before committing.&nbsp; And the other I didn’t have to switch branches in Mercurial (more on that later).&nbsp; But aside from that, it’s pretty much the same, from a user’s point of view.&nbsp; Check this fantastic thread on StackOverflow for one of the best comparisons on the net if you want to dive into technical details. So far, there are only two things that bother me having switched: &nbsp; a) No fast-forward merge.&nbsp; You need to manually rebase and then commit. &nbsp; b) No automatic commit after a conflict free merge. These are fairly minor annoyances, but can be scripted/aliased away.&nbsp; Or if you don’t like those defaults in Git, you can override them in the command arguments or set them in gitconfig.&nbsp; Mercurial similarly can change default arguments in its hgrc/mercurial.ini. One of the biggest advantages of Git is easily switching between all its local lightweight branches at lightning speed.&nbsp; Tangled source code is no more!&nbsp; I was confused with Mercurial’s bookmarks when I first used them because all it does is label your head with something.&nbsp; I don’t know why this is, but it is the same as git checkout –b, but for some reason I visualized Git “branching” the latest commit into two paths.&nbsp; But how do you do that if they’re the same?&nbsp; It should only branch after a commit which introduces changes, which is what Mercurial does.&nbsp; In this scenario, Mercurial is more explicit, whereas Git is implicit. Using bookmarks, you can mimic Git’s workflow like this: &nbsp; Git Mercurial Create a bunch of ‘working areas’ git branch feature1 hg book feature1 &nbsp; git branch feature2 hg book feature2 Switch/commit/hack/commit git checkout feature1 hg up feature1 &nbsp; git commit –a –m “feature1” hg commit –m “feature1” &nbsp; git checkout feature2 hg up feature2 &nbsp; git commit –a –m “feature1” hg commit –m “feature2” Sync up stream git pull master hg pull &nbsp; git checkout master hg up default Merge in 1 feature git merge feature1 hg merge feature1 &nbsp; &nbsp; hg commit –m “merged” Delete branch/bookmark git branch –d feature1 hg book –d feature1 Push git push hg push –r tip Switch back and hack again git checkout feature2 hg up feature2 The –r tip switch on hg push might have raised an eyebrow.&nbsp; This is to tell Mercurial to push all changes that lead to the tip.&nbsp; This will include the changes in feature1 that we just merged in, but exclude all the ones in feature2.&nbsp; If you issue a hg push it will complain and warn you that you’re going to create multiple heads on the remote repository.&nbsp; This is not what you want since there may be unfinished features, experimental branches, etc.&nbsp; Of course, you can force it anyways, but that’s not a good idea. At first, the tip was most confusing to me because I tried to associate it with Git’s master, which was simply not the case.&nbsp; Tip refers to the newest change that you know about.&nbsp; This can be on any branch or bookmark.&nbsp; Once I understood that, and stopped trying to create a Git master equivalent, everything was straightforward. So let’s start with an example.&nbsp; First I create a bookmark feature1 after syncing, and then making a commit looks like this: And then if you switch to feature2 and make a commit, it becomes like this: Here’s where you start thinking, “I don’t have a master which tracks upstream changes, how do I separate my local changes?”&nbsp; And now here’s a situation where Mercurial does more black magic than Git.&nbsp; If there are up stream changes, after issuing hg pull, this happens: Mercurial automatically split my local changes into their own separate branches (actually, heads is the accurate term).&nbsp; After this operation, tip is now tracking the changes that I just pulled in from upstream, instead of my bookmark. From here, it’s simply hg up tip to switch to the “master” branch.&nbsp; Then a hg merge feature1; hg commit, and it becomes like this: Then it’s simply hg push –r tip, and you’re good to go.&nbsp; Basically, if you bookmark every feature/bug you work on, then you should only have one branch that doesn’t have a bookmark, which is the same as the ‘master’ branch from Git. What about Subversion? Whoops, forgot why I switched in the first place.&nbsp; First, install hgsubversion, after that’s set up, simply: hg clone http://path/to/subversion/repository And then it’s just hg pull or hg push.&nbsp; Is it really that simple?&nbsp; Yes, yes it is.

    
  </div>
</div>



    
    <ul class="pagination">
        
        <li>
            <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
        </li>
        
        <li
        >
        <a href="/page/7/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
        </li>
        
        <li
        ><a href="/">1</a></li>
        
        <li
        ><a href="/page/2/">2</a></li>
        
        <li
        ><a href="/page/3/">3</a></li>
        
        <li
        ><a href="/page/4/">4</a></li>
        
        <li
        ><a href="/page/5/">5</a></li>
        
        <li
        ><a href="/page/6/">6</a></li>
        
        <li
        ><a href="/page/7/">7</a></li>
        
        <li
        class="active"><a href="/page/8/">8</a></li>
        
        <li
        ><a href="/page/9/">9</a></li>
        
        <li
        ><a href="/page/10/">10</a></li>
        
        <li
        ><a href="/page/11/">11</a></li>
        
        <li
        ><a href="/page/12/">12</a></li>
        
        <li
        ><a href="/page/13/">13</a></li>
        
        <li
        ><a href="/page/14/">14</a></li>
        
        <li
        ><a href="/page/15/">15</a></li>
        
        <li
        ><a href="/page/16/">16</a></li>
        
        <li
        ><a href="/page/17/">17</a></li>
        
        <li
        >
        <a href="/page/9/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
        </li>
        
        <li>
            <a href="/page/17/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
        </li>
        
    </ul>
    

    </div>

    <footer>
      <p class="text-muted credit">&copy; bling on software 2015. All rights reserved. </p>
    </footer>

    <script src="http://bling.github.io/js/jquery-1.10.2.min.js"></script>
    <script src="http://bling.github.io/js/bootstrap.min.js"></script>
    <script src="http://bling.github.io/js/bootstrap.js"></script>
    <script type="text/javascript" src="http://bling.github.io/js/hc.js"></script>

    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38439430-2', 'auto');
ga('send', 'pageview');
</script>

  </body>
</html>

